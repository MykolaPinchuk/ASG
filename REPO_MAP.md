# REPO_MAP

Keep this file short. Update it only when something important changes.

## Critical entrypoints (read these first for work)
- `agents.md` — general instructions (generated by `context-manager-1`).
- `repo_workflow.md` — repo-specific workflow (triggers + procedures).
- `onboarding.md` — onboarding procedure when triggered.
- `HANDOFF.md` — current objective, next steps, and state.
- `REPO_MAP.md` — index of important files and hot paths.
- `README.md` — repo overview and agent start points.
- `agent_logs/current.md` — live execution log for this cycle.
- `docs/planning/MVP_SPEC.md` — normative MVP rules/spec (source of truth).
- `docs/planning/IMPLEMENTATION_PLAN.md` — milestone plan.
- `docs/planning/ROADMAP.md` — post-MVP direction.
- `docs/diagnostics/2026-01-27_oss_openai_compat_debugging.md` — OSS provider debugging notes (failure modes + tests).
- `viewer/index.html` — replay viewer (load `replays/*.json`).
- `scenarios/scenario_01.json` — initial scenario data.
- `schemas/replay.schema.json` — replay JSON schema.
- `schemas/agent_api.schema.json` — agent API schema (`src/controllers/httpAgentController.ts` ↔ `src/cli/agentServer.ts`).

## Where results live (ignored by default)
- `agent_logs/` — per-cycle logs and index.
- `replays/` — replay outputs (ignored; keep examples small if ever committed).
- `runs/` — per-run outputs (ignored).

## Core runtime (engine → replay)
- `src/game/engine.ts` — turn/ply resolution and state transitions.
- `src/game/match.ts` — match loop and replay building.
- `src/game/types.ts` — core types + replay schema types.
- `src/scenario/loadScenario.ts` — scenario loader + validation.
- `src/cli/runMatch.ts` — `npm run match` entrypoint.

## Agent plumbing
- `src/controllers/httpAgentController.ts` — game runner → HTTP agent API.
- `src/cli/agentServer.ts` — HTTP agent server (providers: `stub`, `openai_compat`).
- `src/providers/openaiCompat.ts` — OpenAI-compatible client + parsing/tooling behavior.

## Model tooling
- `configs/oss_models.json` — OSS model allowlist / priority list (derived from TML-bench).
- `src/llm/models.ts` — shared OSS allowlist + OpenAI-compatible `/models` helpers.
- `src/cli/listModels.ts` — `npm run agent:list-models`.
- `src/cli/agentVsRandom.ts` — `npm run agent:vs-random` (eval harness; spawns `agent:server`).
- `src/cli/sweepOssModels.ts` — `npm run agent:sweep-oss` (multi-provider sweep).

## Utility scripts
- `src/cli/reportBatch.ts` — batch metrics report (`npm run report`).

## Local-only directories (ignored)
- `secrets/` — local credentials (see `secrets/README.md`).

## Hot paths (last 1–2 cycles)
- `src/providers/openaiCompat.ts` — harden model output parsing / tool-use.
- `src/cli/agentVsRandom.ts` — evaluation + replay naming/observability.
- `viewer/index.html` — show agent/provider/model and add explanations.

## New important files since last cycle
- `configs/oss_models.json` — OSS model allowlist/priority list (derived from TML-bench).
- `src/llm/models.ts` — shared helpers for OSS allowlist + OpenAI-compatible `/models`.
